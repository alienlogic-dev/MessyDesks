<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <!-- Codemirror CSS -->
    <link rel="stylesheet" href="node_modules/codemirror/lib/codemirror.css">

    <title>MessyDesk</title>

    <style type="text/css">
      .hide {
        display: none!important;
      }

      .wire {
        pointer-events: none;
      }
      .pin:hover {
        stroke: red;
      }

      .componentbox {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        width: 150px;
        font-size: 0.8em;
        overflow-y: scroll;
        background-color: white;
      }

      .toolbox {
        position: fixed;
        right: 0;
        left: 150px;
        top: 0;
        text-align: right;
        z-index: 1;
      }

      .editbox {
        font-size: 1em;
      }
      .editbox.hidden > div {
        display: none;
      }
      .editbox.hidden > ol {
        display: none;
      }

      .workbox {
        margin-left: 150px;
      }
      .workbox .CodeMirror {
        margin-top: 50px;
        height: calc(100vh - 50px);
      }

      .compilerbox {
        position: fixed;
        left: 150px;
        right: 0;
        bottom: 0;
        z-index: 100;
      }

      .dropdown {
        display: inline-block;
      }

      .CodeMirror {
        z-index: 0;
      }

      .icon {
        position: fixed;
        right: 0;
        bottom: 0;
      }
    </style>
    <style type="text/css">
      .inputfile {
          width: 0.1px;
          height: 0.1px;
          opacity: 0;
          overflow: hidden;
          position: absolute;
          z-index: -1;
      }

      .inputfile + label {
          max-width: 80%;
          font-size: 1.25rem;
          /* 20px */
          font-weight: 700;
          text-overflow: ellipsis;
          white-space: nowrap;
          cursor: pointer;
          display: inline-block;
          overflow: hidden;
          padding: 0.625rem 1.25rem;
          /* 10px 20px */
      }

      .no-js .inputfile + label {
          display: none;
      }

      .inputfile:focus + label,
      .inputfile.has-focus + label {
          outline: 1px dotted #000;
          outline: -webkit-focus-ring-color auto 5px;
      }

      .inputfile + label * {
          /* pointer-events: none; */
          /* in case of FastClick lib use */
      }

      .inputfile + label svg {
          width: 1em;
          height: 1em;
          vertical-align: middle;
          fill: currentColor;
          margin-top: -0.25em;
          /* 4px */
          margin-right: 0.25em;
          /* 4px */
      }
    </style>
  </head>
  <body>
    <input type="file" name="file" id="file" class="inputfile" accept=".prj" onchange="openFile(event)"/>
    <input type="file" name="lib" id="lib" class="inputfile" accept=".prj" onchange="openAsLib(event)"/>
    
    <div class="componentbox">
      <ul id="toolbox" class="list-group list-group-flush">
        <li class="list-group-item">Loading...</li>
      </ul>
    </div>

    <div class="workbox">
      <div class="toolbox p-2 d-flex justify-content-between">
        <div id="editbox" class="editbox hidden">
          <div class="btn-group float-left mr-2 hidden" role="group">
            <button class="btn btn-dark" onclick="cancelLastComponentEdit()"><i class="fas fa-times fa-fw"></i></button>
            <button class="btn btn-primary" onclick="endLastComponentEdit()"><i class="fas fa-check fa-fw"></i></button>
          </div>

          <button id="btnSwitchToSilicon" class="btn btn-dark float-left mr-2 hide" onclick="switchToSilicon()"><i class="fas fa-code"></i></button>

          <div id="btnSwitchCode" class="dropdown float-left mr-2 hide">
            <button class="btn btn-dark dropdown-toggle" type="button" data-toggle="dropdown">
              Silicon
            </button>
            <div class="dropdown-menu">
              <button class="dropdown-item" type="button" onclick="selectEditorCode('silicon')">Silicon</button>
            </div>
          </div>

          <ol class="breadcrumb m-0 p-2 pl-3 pr-3 hidden">
            <li class="breadcrumb-item">test</li>
          </ol>
        </div>

        <div>
          <button id="btnSaveProject" class="btn btn-dark" onclick="saveProjectToFile()"><i class="far fa-save"></i></button>
          <div class="btn-group" role="group" aria-label="Basic example">
            <label id="btnOpenProject" class="btn btn-dark m-0" for="file"><i class="far fa-folder-open"></i></label>
            <label id="btnOpenProject" class="btn btn-dark m-0" for="lib"><i class="fas fa-book-open"></i></label>
          </div>
          <button id="btnNewComponent" class="btn btn-dark" data-toggle="modal" data-target="#modalNewComponent"><i class="fas fa-microchip"></i></button>
          
          <div class="btn-group" role="group">
            <div id="btnSwitchCompiler" class="btn-group" role="group">
              <button type="button" class="btn btn-dark dropdown-toggle" data-toggle="dropdown">
                C++
              </button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="#"></a>
              </div>
            </div>
            <button id="btnCompileBoard" type="button" class="btn btn-dark">
              <i class="fas fa-circle-notch fa-spin hide"></i>
              <i class="fas fa-cubes"></i>
            </button>
          </div>
        </div>
      </div>
      
      <div id="drawing" class="wireboard"></div>
      <textarea id="siliconCodeArea" class="hide">function test() { var a = 'abc'; }</textarea>
      
      <img src="assets/icons/png/icon_512.png" class="icon mr-2 mb-2" height="32px" />
    </div>

    <div id="modalComponentOptions" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Modal body text goes here.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary btnComponentOptionsApply">Apply</button>
          </div>
        </div>
      </div>
    </div>

    <div id="modalNewComponent" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">New component</h5>
            <button type="button" class="close" data-dismiss="modal">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group m-0">
              <input type="text" class="form-control" id="newComponentName" placeholder="Name">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" onclick="newEmptyComponent()">New</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>
    <script>window.$ = window.jQuery = require('jquery');</script>
    <script>const prompt = require('electron-prompt');</script>

    <script type="text/javascript" src="node_modules/popper.js/dist/umd/popper.min.js"></script>
    <script type="text/javascript" src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="node_modules/codemirror/lib/codemirror.js"></script>
    <script src="node_modules/codemirror/mode/javascript/javascript.js"></script>

    <script type="text/javascript" src="node_modules/svg.js/dist/svg.min.js"></script>
    <script type="text/javascript" src="core/svg.draggable.min.js"></script>

    <script type="text/javascript" src="core/6502.min.js"></script>
    <script type="text/javascript" src="core/mtWiring.js"></script>
    <script type="text/javascript" src="core/main.js"></script>
    <script type="text/javascript" src="core/library.js"></script>
    <script type="text/javascript" src="core/cpp_compiler.js"></script>

    <script>
      // You can also require other files to run in this process
      require('./renderer.js')
    </script>

  </body>
</html>